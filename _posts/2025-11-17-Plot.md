---
title: "Mini Project: Well Log Plotting and Data Diagnostics"
date: 2025-11-24
permalink: /posts/log-plot-bdnc01/
tags:
  - petrophysics
  - well-logs
  - las-file
  - python
  - Suphanburi-Basin
---

# üõ¢Ô∏è Mini Project: Well Log Plotting and Data Diagnostics in Suphanburi Basin

This project focuses on loading and plotting well log data from the **BDN-C01** well, located in the **Suphanburi Basin** area of Thailand. The main objective is to visualize the primary petrophysical logs and perform essential data quality control (QC) against the unique data format constraints of this specific dataset.

### 1. Data Context and Mnemonic Mapping Challenge

The well logs analyzed here originate from the **Suphanburi Basin**, a region known for its complex geological setting and presence of exploration targets. 

[Image of Suphanburi Basin location map]
 The primary challenge lies in the **non-standard log mnemonics** used in the file (`BDN-C01_well.las`).

| Log Function | Standard Mnemonic (Code Key) | Mnemonic in `BDN-C01_well.las` | Purpose |
| :---: | :---: | :---: | :---: |
| **Gamma Ray** | `GR` | **`GRGC`** | Lithology Indicator |
| **Sonic P-wave** | `DTCO` | **`TR21`** | Slowness (Found 99.74% missing data) |
| **Density** | `DEN` | **`DEN`** | Rock Bulk Density |
| **Neutron Porosity** | `NPHI` | **`NPOR`** | Porosity |
| **Resistivity** | `RES` | **`R60T`** | Fluid Saturation (Log Scale) |

---

### 2. Data Diagnostic: The Case of TR21

During the plotting process, the **TR21** (Sonic) log failed to display correctly across the full depth. A dedicated data check confirmed that **99.74%** of the data points were the Null value (`-999.25`), meaning the log is effectively usable only in a small section at the bottom of the well (from **2866.5 m to 2871.2 m**). This highlights the necessity of thorough data QC before proceeding to petrophysical analysis in the **Suphanburi Basin** study area.

---

### 3. Final Python Code (`log_plotter.py`)

This is the complete, final code used to generate the 5-track plot, ensuring all logs are correctly retrieved, scaled, and plotted against depth. The code also handles converting Null values to `NaN` for proper visualization.

```python
import lasio
import matplotlib.pyplot as plt
import numpy as np

def plot_well_logs_final(las_path):
    """
    Load well log data using the FINAL CORRECTED mnemonics found in the file content (R60T for Resistivity)
    and plot 5 key logs in separated tracks.
    """
    try:
        # 1. Load LAS file
        las = lasio.read(las_path)
    except Exception as e:
        print(f"Error loading LAS file: {e}")
        return

    # *** FINAL CONFIRMED CORRECT LOG MNEMONICS FROM FILE CONTENT ***
    logs_config = {
        # Log 1: Gamma Ray -> GRGC
        'GR':   {'mnemonic': 'GRGC', 'label': 'GR (API)',          'color': 'black',    'limits': [0, 150], 'reverse_x': False, 'xscale': 'linear'},
        # Log 2: Sonic Transit Time (P-wave) -> TR21
        'DTCO': {'mnemonic': 'TR21', 'label': 'DTCO (us/ft)',      'color': 'green',    'limits': [140, 40], 'reverse_x': True, 'xscale': 'linear'}, 
        # Log 3: Bulk Density -> DEN
        'DEN':  {'mnemonic': 'DEN',  'label': 'DEN (g/cm3)',       'color': 'red',      'limits': [1.95, 2.95], 'reverse_x': False, 'xscale': 'linear'},
        # Log 4: Neutron Porosity -> NPOR
        'NPHI': {'mnemonic': 'NPOR', 'label': 'NPHI (frac.)',      'color': 'blue',     'limits': [0.45, -0.15], 'reverse_x': True, 'xscale': 'linear'}, 
        # Log 5: Resistivity -> R60T (Confirmed and selected)
        'RES':  {'mnemonic': 'R60T', 'label': 'R60T (Ohm.m)',       'color': 'purple',   'limits': [0.2, 200], 'reverse_x': False, 'xscale': 'log'}, 
        # Optional Log: DTSM -> DT35
        'DTSM': {'mnemonic': 'DT35', 'label': 'DTSM (us/ft)',      'color': 'orange',   'limits': [280, 100], 'reverse_x': True, 'xscale': 'linear'}, 
    }
    
    # Check for the presence of logs and prepare plotting list in desired order
    plot_logs = []
    # Plot order: GR, DTCO (TR21), DEN, NPHI (NPOR), RES (R60T)
    for key in ['GR', 'DTCO', 'DEN', 'NPHI', 'RES']:
        config = logs_config[key]
        if config['mnemonic'] in las.keys():
            plot_logs.append({
                'data': las[config['mnemonic']],
                'config': config
            })
        else:
            print(f"ERROR: Log {config['mnemonic']} (for {key}) not found in the LAS file. Cannot plot {key}.")
            if key == 'RES':
                 print(f"Available Resistivity Logs are: {[k for k in las.keys() if k.startswith('R') and k.endswith('T')]}")

    if not plot_logs:
        print("ERROR: No key logs were found to plot. Check mnemonics in the LAS file.")
        return

    # 2. Setup the plot area (5 Tracks)
    num_tracks = len(plot_logs)
    fig, axes = plt.subplots(ncols=num_tracks, sharey=True, figsize=(num_tracks * 2.5, 12))
    
    if num_tracks == 1:
        axes = [axes]
    
    depth = las.index

    # 3. Plot the logs
    for i, log_info in enumerate(plot_logs):
        ax = axes[i]
        data = log_info['data']
        config = log_info['config']
        
        # Plot the curve
        ax.plot(data, depth, color=config['color'], linewidth=1.5)
        
        # Setup X-axis limits and scale
        ax.set_xlim(config['limits'])
        
        if config.get('xscale') == 'log':
            ax.set_xscale('log')
        
        if config.get('reverse_x'):
            ax.invert_xaxis()
        
        # Setup Labels and Grid
        # ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠ Mnemonic ‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÉ‡∏ô Label ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
        ax.set_xlabel(f"{config['mnemonic']} ({las.curves[config['mnemonic']].unit})", color=config['color']) 
        ax.xaxis.set_label_position("top")
        ax.tick_params(axis='x', colors=config['color'])
        ax.spines["top"].set_edgecolor(config['color'])
        ax.spines["top"].set_linewidth(1.5)
        ax.grid(which='major', color='lightgrey', linestyle='-')
        
        if i == 0:
            ax.set_ylabel(f"Depth ({las.well.STEP.unit})")
        else:
            ax.set_yticklabels([])


    # 4. Final plot customization
    start_depth = las.well.STRT.value
    stop_depth = las.well.STOP.value
    axes[0].invert_yaxis() 
    plt.ylim(stop_depth, start_depth)
    
    fig.suptitle(f"Well Log Plot for {las.well.WELL.value} (Final Corrected Mnemonics)", fontsize=14, y=0.95)

    plt.tight_layout(rect=[0, 0.03, 1, 0.9])
    plt.show()

# 5. Execute the plot function
las_file_path = "BDN-C01_well.las"
plot_well_logs_final(las_file_path)
```

### 5. Result
<img src='/images/OUTPUT.png'> <figcaption>Final 5-Track Log Plot for the BDN-C01 well in the Suphanburi Basin. Note the data gap in TR21 (green curve) across the majority of the well.</figcaption> </figure>
